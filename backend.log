/Users/tjmcgovern/miniconda3/lib/python3.13/site-packages/pydantic/_internal/_config.py:341: UserWarning: Valid config keys have changed in V2:
* 'allow_population_by_field_name' has been renamed to 'populate_by_name'
* 'smart_union' has been removed
  warnings.warn(message, UserWarning)
/Users/tjmcgovern/miniconda3/lib/python3.13/site-packages/pydantic/_internal/_fields.py:161: UserWarning: Field "model_id" has conflict with protected namespace "model_".

You may be able to resolve this warning by setting `model_config['protected_namespaces'] = ()`.
  warnings.warn(
INFO:     Started server process [67477]
INFO:     Waiting for application startup.
INFO:     Application startup complete.
INFO:     Uvicorn running on http://0.0.0.0:8000 (Press CTRL+C to quit)
2025-07-17 14:18:25,594 - __main__ - INFO - [main.py:55] - [186f5ca0] OPTIONS /api/listen - Request started
2025-07-17 14:18:25,595 - __main__ - INFO - [main.py:65] - [186f5ca0] OPTIONS /api/listen - Status: 200 - Time: 0.001s
INFO:     127.0.0.1:51638 - "OPTIONS /api/listen HTTP/1.1" 200 OK
2025-07-17 14:18:25,595 - __main__ - INFO - [main.py:55] - [f00f1065] POST /api/listen - Request started
2025-07-17 14:18:25,596 - __main__ - INFO - [main.py:506] - Listen request - Content length: 544 chars, Voice: JBFqnCBsd6RMkjVDRZzb, Model: eleven_multilingual_v2
2025-07-17 14:18:25,596 - __main__ - INFO - [main.py:544] - Generating summary for TTS - OpenAI model: gpt-3.5-turbo
2025-07-17 14:18:26,956 - httpx - INFO - [_client.py:1026] - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-07-17 14:18:26,959 - __main__ - INFO - [main.py:560] - Summary generated - Processing time: 1.363s, Tokens used: 242, Summary length: 197 chars
2025-07-17 14:18:26,959 - __main__ - INFO - [main.py:565] - Converting summary to audio - ElevenLabs voice: JBFqnCBsd6RMkjVDRZzb
2025-07-17 14:18:26,959 - __main__ - INFO - [main.py:586] - Listen request successful - Total processing time: 1.363s
2025-07-17 14:18:26,959 - __main__ - INFO - [main.py:65] - [f00f1065] POST /api/listen - Status: 200 - Time: 1.364s
INFO:     127.0.0.1:51638 - "POST /api/listen HTTP/1.1" 200 OK
2025-07-17 14:18:27,109 - httpx - INFO - [_client.py:1026] - HTTP Request: POST https://api.elevenlabs.io/v1/text-to-speech/JBFqnCBsd6RMkjVDRZzb/stream?output_format=mp3_44100_128 "HTTP/1.1 401 Unauthorized"
2025-07-17 14:18:27,109 - __main__ - ERROR - [main.py:582] - Error during audio streaming: status_code: 401, body: {'detail': {'status': 'invalid_api_key', 'message': 'Invalid API key'}}
ERROR:    Exception in ASGI application
  + Exception Group Traceback (most recent call last):
  |   File "/Users/tjmcgovern/miniconda3/lib/python3.13/site-packages/starlette/_utils.py", line 87, in collapse_excgroups
  |     yield
  |   File "/Users/tjmcgovern/miniconda3/lib/python3.13/site-packages/starlette/middleware/base.py", line 190, in __call__
  |     async with anyio.create_task_group() as task_group:
  |                ~~~~~~~~~~~~~~~~~~~~~~~^^
  |   File "/Users/tjmcgovern/miniconda3/lib/python3.13/site-packages/anyio/_backends/_asyncio.py", line 772, in __aexit__
  |     raise BaseExceptionGroup(
  |         "unhandled errors in a TaskGroup", self._exceptions
  |     ) from None
  | ExceptionGroup: unhandled errors in a TaskGroup (1 sub-exception)
  +-+---------------- 1 ----------------
    | Exception Group Traceback (most recent call last):
    |   File "/Users/tjmcgovern/miniconda3/lib/python3.13/site-packages/starlette/middleware/base.py", line 192, in __call__
    |     await response(scope, wrapped_receive, send)
    |   File "/Users/tjmcgovern/miniconda3/lib/python3.13/site-packages/starlette/responses.py", line 258, in __call__
    |     async with anyio.create_task_group() as task_group:
    |                ~~~~~~~~~~~~~~~~~~~~~~~^^
    |   File "/Users/tjmcgovern/miniconda3/lib/python3.13/site-packages/anyio/_backends/_asyncio.py", line 772, in __aexit__
    |     raise BaseExceptionGroup(
    |         "unhandled errors in a TaskGroup", self._exceptions
    |     ) from None
    | ExceptionGroup: unhandled errors in a TaskGroup (1 sub-exception)
    +-+---------------- 1 ----------------
      | Exception Group Traceback (most recent call last):
      |   File "/Users/tjmcgovern/miniconda3/lib/python3.13/site-packages/starlette/responses.py", line 261, in wrap
      |     await func()
      |   File "/Users/tjmcgovern/miniconda3/lib/python3.13/site-packages/starlette/middleware/base.py", line 217, in stream_response
      |     return await super().stream_response(send)
      |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
      |   File "/Users/tjmcgovern/miniconda3/lib/python3.13/site-packages/starlette/responses.py", line 250, in stream_response
      |     async for chunk in self.body_iterator:
      |     ...<2 lines>...
      |         await send({"type": "http.response.body", "body": chunk, "more_body": True})
      |   File "/Users/tjmcgovern/miniconda3/lib/python3.13/site-packages/starlette/middleware/base.py", line 181, in body_stream
      |     raise app_exc
      |   File "/Users/tjmcgovern/miniconda3/lib/python3.13/site-packages/starlette/middleware/base.py", line 151, in coro
      |     await self.app(scope, receive_or_disconnect, send_no_error)
      |   File "/Users/tjmcgovern/miniconda3/lib/python3.13/site-packages/starlette/middleware/cors.py", line 93, in __call__
      |     await self.simple_response(scope, receive, send, request_headers=headers)
      |   File "/Users/tjmcgovern/miniconda3/lib/python3.13/site-packages/starlette/middleware/cors.py", line 148, in simple_response
      |     await self.app(scope, receive, send)
      |   File "/Users/tjmcgovern/miniconda3/lib/python3.13/site-packages/starlette/middleware/exceptions.py", line 65, in __call__
      |     await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
      |   File "/Users/tjmcgovern/miniconda3/lib/python3.13/site-packages/starlette/_exception_handler.py", line 64, in wrapped_app
      |     raise exc
      |   File "/Users/tjmcgovern/miniconda3/lib/python3.13/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
      |     await app(scope, receive, sender)
      |   File "/Users/tjmcgovern/miniconda3/lib/python3.13/site-packages/starlette/routing.py", line 756, in __call__
      |     await self.middleware_stack(scope, receive, send)
      |   File "/Users/tjmcgovern/miniconda3/lib/python3.13/site-packages/starlette/routing.py", line 776, in app
      |     await route.handle(scope, receive, send)
      |   File "/Users/tjmcgovern/miniconda3/lib/python3.13/site-packages/starlette/routing.py", line 297, in handle
      |     await self.app(scope, receive, send)
      |   File "/Users/tjmcgovern/miniconda3/lib/python3.13/site-packages/starlette/routing.py", line 77, in app
      |     await wrap_app_handling_exceptions(app, request)(scope, receive, send)
      |   File "/Users/tjmcgovern/miniconda3/lib/python3.13/site-packages/starlette/_exception_handler.py", line 64, in wrapped_app
      |     raise exc
      |   File "/Users/tjmcgovern/miniconda3/lib/python3.13/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
      |     await app(scope, receive, sender)
      |   File "/Users/tjmcgovern/miniconda3/lib/python3.13/site-packages/starlette/routing.py", line 75, in app
      |     await response(scope, receive, send)
      |   File "/Users/tjmcgovern/miniconda3/lib/python3.13/site-packages/starlette/responses.py", line 258, in __call__
      |     async with anyio.create_task_group() as task_group:
      |                ~~~~~~~~~~~~~~~~~~~~~~~^^
      |   File "/Users/tjmcgovern/miniconda3/lib/python3.13/site-packages/anyio/_backends/_asyncio.py", line 772, in __aexit__
      |     raise BaseExceptionGroup(
      |         "unhandled errors in a TaskGroup", self._exceptions
      |     ) from None
      | ExceptionGroup: unhandled errors in a TaskGroup (1 sub-exception)
      +-+---------------- 1 ----------------
        | Traceback (most recent call last):
        |   File "/Users/tjmcgovern/miniconda3/lib/python3.13/site-packages/uvicorn/protocols/http/httptools_impl.py", line 399, in run_asgi
        |     result = await app(  # type: ignore[func-returns-value]
        |              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        |         self.scope, self.receive, self.send
        |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        |     )
        |     ^
        |   File "/Users/tjmcgovern/miniconda3/lib/python3.13/site-packages/uvicorn/middleware/proxy_headers.py", line 70, in __call__
        |     return await self.app(scope, receive, send)
        |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        |   File "/Users/tjmcgovern/miniconda3/lib/python3.13/site-packages/fastapi/applications.py", line 1054, in __call__
        |     await super().__call__(scope, receive, send)
        |   File "/Users/tjmcgovern/miniconda3/lib/python3.13/site-packages/starlette/applications.py", line 123, in __call__
        |     await self.middleware_stack(scope, receive, send)
        |   File "/Users/tjmcgovern/miniconda3/lib/python3.13/site-packages/starlette/middleware/errors.py", line 186, in __call__
        |     raise exc
        |   File "/Users/tjmcgovern/miniconda3/lib/python3.13/site-packages/starlette/middleware/errors.py", line 164, in __call__
        |     await self.app(scope, receive, _send)
        |   File "/Users/tjmcgovern/miniconda3/lib/python3.13/site-packages/starlette/middleware/base.py", line 189, in __call__
        |     with collapse_excgroups():
        |          ~~~~~~~~~~~~~~~~~~^^
        |   File "/Users/tjmcgovern/miniconda3/lib/python3.13/contextlib.py", line 162, in __exit__
        |     self.gen.throw(value)
        |     ~~~~~~~~~~~~~~^^^^^^^
        |   File "/Users/tjmcgovern/miniconda3/lib/python3.13/site-packages/starlette/_utils.py", line 93, in collapse_excgroups
        |     raise exc
        |   File "/Users/tjmcgovern/miniconda3/lib/python3.13/site-packages/starlette/responses.py", line 261, in wrap
        |     await func()
        |   File "/Users/tjmcgovern/miniconda3/lib/python3.13/site-packages/starlette/responses.py", line 250, in stream_response
        |     async for chunk in self.body_iterator:
        |     ...<2 lines>...
        |         await send({"type": "http.response.body", "body": chunk, "more_body": True})
        |   File "/Users/tjmcgovern/miniconda3/lib/python3.13/site-packages/starlette/concurrency.py", line 65, in iterate_in_threadpool
        |     yield await anyio.to_thread.run_sync(_next, as_iterator)
        |           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        |   File "/Users/tjmcgovern/miniconda3/lib/python3.13/site-packages/anyio/to_thread.py", line 56, in run_sync
        |     return await get_async_backend().run_sync_in_worker_thread(
        |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        |         func, args, abandon_on_cancel=abandon_on_cancel, limiter=limiter
        |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        |     )
        |     ^
        |   File "/Users/tjmcgovern/miniconda3/lib/python3.13/site-packages/anyio/_backends/_asyncio.py", line 2470, in run_sync_in_worker_thread
        |     return await future
        |            ^^^^^^^^^^^^
        |   File "/Users/tjmcgovern/miniconda3/lib/python3.13/site-packages/anyio/_backends/_asyncio.py", line 967, in run
        |     result = context.run(func, *args)
        |   File "/Users/tjmcgovern/miniconda3/lib/python3.13/site-packages/starlette/concurrency.py", line 54, in _next
        |     return next(iterator)
        |   File "/Users/tjmcgovern/slopathon1/ShoeStore_Example/chatwidget/backend/main.py", line 577, in generate_audio
        |     for chunk in audio_stream:
        |                  ^^^^^^^^^^^^
        |   File "/Users/tjmcgovern/miniconda3/lib/python3.13/site-packages/elevenlabs/text_to_speech/client.py", line 415, in convert_as_stream
        |     raise ApiError(status_code=_response.status_code, body=_response_json)
        | elevenlabs.core.api_error.ApiError: status_code: 401, body: {'detail': {'status': 'invalid_api_key', 'message': 'Invalid API key'}}
        +------------------------------------

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/tjmcgovern/miniconda3/lib/python3.13/site-packages/uvicorn/protocols/http/httptools_impl.py", line 399, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        self.scope, self.receive, self.send
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/tjmcgovern/miniconda3/lib/python3.13/site-packages/uvicorn/middleware/proxy_headers.py", line 70, in __call__
    return await self.app(scope, receive, send)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/tjmcgovern/miniconda3/lib/python3.13/site-packages/fastapi/applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
  File "/Users/tjmcgovern/miniconda3/lib/python3.13/site-packages/starlette/applications.py", line 123, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/Users/tjmcgovern/miniconda3/lib/python3.13/site-packages/starlette/middleware/errors.py", line 186, in __call__
    raise exc
  File "/Users/tjmcgovern/miniconda3/lib/python3.13/site-packages/starlette/middleware/errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
  File "/Users/tjmcgovern/miniconda3/lib/python3.13/site-packages/starlette/middleware/base.py", line 189, in __call__
    with collapse_excgroups():
         ~~~~~~~~~~~~~~~~~~^^
  File "/Users/tjmcgovern/miniconda3/lib/python3.13/contextlib.py", line 162, in __exit__
    self.gen.throw(value)
    ~~~~~~~~~~~~~~^^^^^^^
  File "/Users/tjmcgovern/miniconda3/lib/python3.13/site-packages/starlette/_utils.py", line 93, in collapse_excgroups
    raise exc
  File "/Users/tjmcgovern/miniconda3/lib/python3.13/site-packages/starlette/responses.py", line 261, in wrap
    await func()
  File "/Users/tjmcgovern/miniconda3/lib/python3.13/site-packages/starlette/responses.py", line 250, in stream_response
    async for chunk in self.body_iterator:
    ...<2 lines>...
        await send({"type": "http.response.body", "body": chunk, "more_body": True})
  File "/Users/tjmcgovern/miniconda3/lib/python3.13/site-packages/starlette/concurrency.py", line 65, in iterate_in_threadpool
    yield await anyio.to_thread.run_sync(_next, as_iterator)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/tjmcgovern/miniconda3/lib/python3.13/site-packages/anyio/to_thread.py", line 56, in run_sync
    return await get_async_backend().run_sync_in_worker_thread(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        func, args, abandon_on_cancel=abandon_on_cancel, limiter=limiter
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/tjmcgovern/miniconda3/lib/python3.13/site-packages/anyio/_backends/_asyncio.py", line 2470, in run_sync_in_worker_thread
    return await future
           ^^^^^^^^^^^^
  File "/Users/tjmcgovern/miniconda3/lib/python3.13/site-packages/anyio/_backends/_asyncio.py", line 967, in run
    result = context.run(func, *args)
  File "/Users/tjmcgovern/miniconda3/lib/python3.13/site-packages/starlette/concurrency.py", line 54, in _next
    return next(iterator)
  File "/Users/tjmcgovern/slopathon1/ShoeStore_Example/chatwidget/backend/main.py", line 577, in generate_audio
    for chunk in audio_stream:
                 ^^^^^^^^^^^^
  File "/Users/tjmcgovern/miniconda3/lib/python3.13/site-packages/elevenlabs/text_to_speech/client.py", line 415, in convert_as_stream
    raise ApiError(status_code=_response.status_code, body=_response_json)
elevenlabs.core.api_error.ApiError: status_code: 401, body: {'detail': {'status': 'invalid_api_key', 'message': 'Invalid API key'}}
INFO:     Shutting down
INFO:     Waiting for application shutdown.
INFO:     Application shutdown complete.
INFO:     Finished server process [67477]
